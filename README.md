# Luma Data Scraper 浏览器插件

一个帮助用户从Luma网站抓取数据并实现自动翻页功能的Chrome浏览器插件。

## 功能特性

- ✅ 自动获取 `luma.auth-session-key` 认证cookie
- ✅ **API模式**: 直接调用 Luma API 获取访客列表数据
- ✅ **页面模式**: 传统翻页抓取网页内容
- ✅ **智能模式**: 自动识别事件页面并选择最佳抓取方式
- ✅ 数据导出（CSV格式）
- ✅ 实时抓取进度显示
- ✅ 抓取历史管理
- ✅ 悬浮控制面板
- ✅ 可配置抓取参数

## 安装方法

### 开发者模式安装

1. 打开Chrome浏览器
2. 访问 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择这个插件目录（luma_plug-in文件夹）
6. 插件安装完成

## 使用方法

### 第一步：准备工作
1. 确保已登录Luma账户
2. 打开Luma网站的任意页面（如事件列表页）

### 第二步：启动插件
1. 点击浏览器工具栏中的插件图标
2. 查看插件状态，确认已连接到Luma网站
3. 检查Cookies状态，确认已获取到登录信息

### 第三步：配置抓取参数
1. 设置最大抓取页数（建议不超过20页）
2. 设置翻页延迟（建议2-3秒，避免过于频繁的请求）

### 第四步：开始抓取
1. 点击"开始抓取"按钮
2. 观察抓取进度和状态
3. 可随时点击"停止"按钮中断抓取

### 第五步：导出数据
1. 抓取完成后点击"导出数据"
2. 数据将以CSV格式下载
3. 可在"查看历史"中管理之前的抓取记录

## 文件结构

```
luma_plug-in/
├── manifest.json          # 插件配置文件
├── popup.html             # 弹窗界面
├── css/
│   └── popup.css          # 弹窗样式
├── js/
│   ├── background.js      # 后台脚本（处理cookies）
│   ├── content.js         # 内容脚本（页面注入，实现抓取）
│   └── popup.js           # 弹窗脚本
├── icons/
│   └── icon.svg           # 插件图标
└── README.md              # 说明文档
```

## 技术实现

### 权限说明
- `cookies`: 读取Luma网站的cookies用于身份验证
- `activeTab`: 与当前活动标签页交互
- `storage`: 本地存储抓取的数据
- `*://*.luma.ai/*` 和 `*://*.lu.ma/*`: 访问Luma网站域名

### 核心功能
1. **Background Script**: 处理cookies获取和数据存储
2. **Content Script**: 注入到Luma页面，实现数据抓取和翻页
3. **Popup Interface**: 用户控制界面

## 注意事项

1. **使用限制**
   - 请确保已登录Luma账户
   - 建议设置合适的延迟时间（至少2秒）
   - 不要过度频繁地抓取，避免对服务器造成压力

2. **数据格式**
   - 导出的数据为CSV格式
   - 包含页面元素的文本内容、链接、图片等信息
   - 每条记录包含抓取时间、页面URL等元数据

3. **兼容性**
   - 支持Chrome浏览器（Manifest V3）
   - 理论上兼容其他基于Chromium的浏览器
   - 需要Luma网站页面结构稳定

## 故障排除

### 常见问题

1. **插件显示"未连接"**
   - 确保当前页面是Luma网站
   - 刷新页面后重试

2. **无法获取Cookies**
   - 确保已登录Luma账户
   - 检查浏览器是否允许cookies
   - 尝试重新登录

3. **抓取无数据**
   - 检查页面是否有内容
   - 页面结构可能发生变化，需要更新选择器
   - 确保网络连接正常

4. **翻页失败**
   - 检查是否有下一页按钮
   - 延迟时间可能太短，尝试增加延迟
   - 页面可能使用了动态加载，需要等待更长时间

## 开发说明

如需修改插件功能，主要编辑以下文件：

- `js/content.js`: 修改数据抓取逻辑和页面选择器
- `js/popup.js`: 修改用户界面逻辑
- `css/popup.css`: 修改界面样式
- `manifest.json`: 修改权限和配置

## 免责声明

此插件仅用于个人学习和研究目的。使用时请遵守Luma网站的使用条款和robots.txt规则，不要进行大规模自动化抓取或其他可能违反服务条款的行为。

## 图标说明

目前使用临时的SVG图标。在生产环境中，建议创建以下尺寸的PNG图标：
- 16x16 px (工具栏小图标)
- 32x32 px (扩展管理页面)  
- 48x48 px (扩展管理页面)
- 128x128 px (Chrome Web Store)

将图标文件放在 `icons/` 目录下并更新 `manifest.json` 中的图标路径。